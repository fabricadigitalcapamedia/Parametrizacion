<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>Subflujo G Integraciones HPSA IMS Claro</title>
  <style>
:root{--rojo:#E30613;--gris:#6B7280}
*{box-sizing:border-box}
body{margin:0;font-family:Segoe UI,Roboto,Arial,sans-serif;background:#fff;color:#111}
header{padding:12px 16px;border-bottom:3px solid var(--rojo);display:flex;justify-content:space-between;align-items:center}
h1{font-size:18px;margin:0}.tag{background:var(--rojo);color:#fff;border-radius:6px;padding:4px 8px;font-size:12px}
main{display:grid;grid-template-columns:1.2fr .8fr;gap:16px;padding:16px;align-items:start}
.canvas{position:relative;border:1px solid #e5e7eb;border-radius:12px;min-height:580px;background:#fff;overflow:hidden}
.panel{border:1px solid #e5e7eb;border-radius:12px;padding:12px;background:#fff}
.node{position:absolute;min-width:240px;background:#fff;border:1px solid #e5e7eb;border-left:6px solid var(--rojo);border-radius:10px;padding:10px 12px;cursor:default;box-shadow:0 1px 2px rgba(16,24,40,.06)}
.node h3{font-size:14px;margin:0 0 4px 0}.node p{font-size:12px;margin:0;color:#374151}
.arrow{stroke:var(--gris);stroke-width:2;fill:none;marker-end:url(#arr)}
.bk-list{margin:8px 0 0 0;padding:0;list-style:none}
.bk-list li{margin:6px 0;font-size:14px}
.bk-btn{display:inline-flex;align-items:center;gap:6px;border:1px solid #e5e7eb;border-radius:8px;padding:6px 10px;text-decoration:none;color:#111}
.bk-btn:hover{background:#f7f8fa}
.icon{width:14px;height:14px;border-radius:50%;background:#2563eb;display:inline-block}
@media (max-width:1100px){ main{grid-template-columns:1fr;}.panel{position:relative;top:auto;height:auto;max-height:none}}
</style>
</head>
<body>
  <header>
    <h1>Subflujo G Integraciones HPSA IMS Claro</h1>
    <span class="tag">Institucional</span>
  </header>

  <main>
    <section class="canvas">
      <svg width="0" height="0">
        <defs>
          <marker id="arr" markerWidth="10" markerHeight="8" refX="9" refY="4" orient="auto" markerUnits="strokeWidth">
            <path d="M0,0 L10,4 L0,8 z" fill="var(--gris)"/>
          </marker>
        </defs>
      </svg>

      <div class="node" style="left:40px;top:120px">
        <h3>B1. Recepción</h3>
        <p>Ingreso MyAsistencia360.</p>
      </div>

      <div class="node" style="left:320px;top:120px">
        <h3>B2. Verificar existencia</h3>
        <p>Servicio e inventario en AI / IC / MC.</p>
      </div>

      <svg class="arrowlayer" style="position:absolute;inset:0;pointer-events:none">
        <path class="arrow" d="M260 155 H320"/>
      </svg>

      <div class="node" style="left:480px;top:220px">
        <h3>B3. Analizar relación</h3>
        <p>Validar servicio → inventario.</p>
      </div>

      <svg class="arrowlayer" style="position:absolute;inset:0;pointer-events:none">
        <path class="arrow" d="M420 160 C 520 160, 520 220, 520 220"/>
      </svg>

      <div class="node" style="left:320px;top:300px">
        <h3>B4. Corrección / recreación</h3>
        <p>Recrear y asociar correctamente.</p>
      </div>

      <svg class="arrowlayer" style="position:absolute;inset:0;pointer-events:none">
        <path class="arrow" d="M540 240 V300"/>
      </svg>

      <div class="node" style="left:420px;top:420px">
        <h3>B5. Validación y cierre</h3>
        <p>QA, evidencias y BK.</p>
      </div>

      <svg class="arrowlayer" style="position:absolute;inset:0;pointer-events:none">
        <path class="arrow" d="M380 340 C 480 380, 480 420, 480 420"/>
      </svg>
    </section>

    <aside class="panel">
      <h2 style="margin:0 0 8px 0">B2. Verificar existencia</h2>
      <div style="font-size:12px;color:#6b7280;margin-bottom:8px">
        Si el incidente llega por <strong>correo o llamada</strong>, debe registrarse en <strong>MyAsistencia360</strong> antes de continuar.
      </div>

      <h3 style="margin:12px 0 6px 0">Ruta de ejecución</h3>
      <ul style="margin:0 0 10px 18px;padding:0">
        <li>Validar integración HPSA/IMS.</li><li>Confirmar consistencia entre sistemas.</li>
      </ul>

      <h3 style="margin:12px 0 6px 0">Artículos BK</h3>
      <ul class="bk-list" id="bkList"></ul>
    </aside>
  </main>

  <script>

  <script src="bk.config.js"></script>
  <script>
    function renderBKList(sectionKey) {
      var ul = document.getElementById('bkList');
      if (!ul) return;
      var cfg = window.BK_CONFIG || {};
      var list = cfg[sectionKey] || [];
      ul.innerHTML = '';
      if (!list.length) {
        ul.innerHTML = '<li style="color:#6b7280">Sin BK registrados para ' + sectionKey + '</li>';
        return;
      }
      list.forEach(function(item) {
        var li = document.createElement('li');
        var a = document.createElement('a');
        a.href = item.url || '#';
        a.target = '_blank';
        a.rel = 'noopener noreferrer';
        a.className = 'bk-btn';
        a.textContent = item.label || item.url;
        li.appendChild(a);
        ul.appendChild(li);
      });
    }
    renderBKList('G');
  </script>
</body>
</html>
